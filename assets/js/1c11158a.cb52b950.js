"use strict";(self.webpackChunkvkpr_docs=self.webpackChunkvkpr_docs||[]).push([[5773],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),h=o,m=d["".concat(s,".").concat(h)]||d[h]||u[h]||i;return n?r.createElement(m,a(a({ref:t},c),{},{components:n})):r.createElement(m,a({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,a[1]=l;for(var p=2;p<i;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2948:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const i={sidebar_position:2,sidebar_label:"Pipelines",title:"Pipelines"},a="Most common error using VKPR Pipelines",l={unversionedId:"troubleshooting/pipeline",id:"troubleshooting/pipeline",title:"Pipelines",description:"Destroy pipeline not complete or timeout (AWS)",source:"@site/docs/troubleshooting/pipeline.mdx",sourceDirName:"troubleshooting",slug:"/troubleshooting/pipeline",permalink:"/docs/troubleshooting/pipeline",draft:!1,editUrl:"https://github.com/vertigobr/vkpr-docs/edit/main/docs/troubleshooting/pipeline.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,sidebar_label:"Pipelines",title:"Pipelines"},sidebar:"tutorialSidebar",previous:{title:"External-DNS",permalink:"/docs/troubleshooting/external-dns"}},s={},p=[{value:"Destroy pipeline not complete or timeout (AWS)",id:"destroy-pipeline-not-complete-or-timeout-aws",level:2},{value:"Solving",id:"solving",level:3},{value:"Error when creating the subnets (AWS)",id:"error-when-creating-the-subnets-aws",level:2},{value:"Solving",id:"solving-1",level:3}],c={toc:p};function u(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,r.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"most-common-error-using-vkpr-pipelines"},"Most common error using VKPR Pipelines"),(0,o.kt)("h2",{id:"destroy-pipeline-not-complete-or-timeout-aws"},"Destroy pipeline not complete or timeout (AWS)"),(0,o.kt)("p",null,"When there is one of these two scenarios, possibly because of resources created by the installed applications that linked to what was created."),(0,o.kt)("p",null,"An example is creating Load Balancers. If any of our stacks were installed, it will create an ",(0,o.kt)("inlineCode",{parentName:"p"},"ELB")," that will link with the ",(0,o.kt)("inlineCode",{parentName:"p"},"VPC and EC2")," created by the script and when you delete them it will inform you that they have dependencies not specified in ",(0,o.kt)("inlineCode",{parentName:"p"},"tfstate"),"."),(0,o.kt)("h3",{id:"solving"},"Solving"),(0,o.kt)("p",null,"There are 3 ways to solve the problem, which are:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"You may be removing the application that ended up creating the resources in the cloud, so that it is destroyed along with the application"),(0,o.kt)("li",{parentName:"ol"},"Refreshing and importing the terraform state and destroying them"),(0,o.kt)("li",{parentName:"ol"},"Destroying all the infrastructure at hand in the cloud")),(0,o.kt)("h2",{id:"error-when-creating-the-subnets-aws"},"Error when creating the subnets (AWS)"),(0,o.kt)("p",null,"In some deploys, there is a problem when trying to upload the subnets in the regions."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"subnet-error",src:n(9985).Z,width:"840",height:"375"})),(0,o.kt)("h3",{id:"solving-1"},"Solving"),(0,o.kt)("p",null,"To proceed with the installation correctly if there is any problem, first run the destroy command to clean all the resources that were created previously."),(0,o.kt)("p",null,"Then change the ",(0,o.kt)("inlineCode",{parentName:"p"},"config/defaults.yml")," file of the branch that triggered the pipeline. Adding availability zones that can be used to create subnets (at least two zones)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml"},"---\naws_availability_zones:\n  - us-east-1a\n  - us-east-1b\n  - us-east-1c\n")))}u.isMDXComponent=!0},9985:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/error-subnets-7cf6ff79f055833fbaceaac0af00603c.png"}}]);